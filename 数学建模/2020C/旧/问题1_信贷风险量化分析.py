#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
é—®é¢˜1ï¼šå¯¹é™„ä»¶1ä¸­123å®¶ä¼ä¸šçš„ä¿¡è´·é£é™©è¿›è¡Œé‡åŒ–åˆ†æ
ç»™å‡ºè¯¥é“¶è¡Œåœ¨å¹´åº¦ä¿¡è´·æ€»é¢å›ºå®šæ—¶å¯¹è¿™äº›ä¼ä¸šçš„ä¿¡è´·ç­–ç•¥
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.preprocessing import StandardScaler
from sklearn.ensemble import RandomForestClassifier
from sklearn.model_selection import cross_val_score
import warnings
warnings.filterwarnings('ignore')

plt.rcParams['font.sans-serif'] = ['SimHei', 'DejaVu Sans']
plt.rcParams['axes.unicode_minus'] = False

class CreditRiskAnalyzer:
    """ä¿¡è´·é£é™©é‡åŒ–åˆ†æå™¨"""
    
    def __init__(self):
        self.ä¼ä¸šä¿¡æ¯ = None
        self.è¿›é¡¹å‘ç¥¨ = None
        self.é”€é¡¹å‘ç¥¨ = None
        self.å®¢æˆ·æµå¤±ç‡æ•°æ® = None
        self.ç»¼åˆæ•°æ® = None
        self.é£é™©è¯„åˆ† = None
        
    def load_data(self):
        """åŠ è½½é™„ä»¶1å’Œé™„ä»¶3æ•°æ®"""
        try:
            print("ğŸ“Š æ­£åœ¨åŠ è½½é™„ä»¶1å’Œé™„ä»¶3æ•°æ®...")
            
            # è¯»å–é™„ä»¶1å„å·¥ä½œè¡¨
            self.ä¼ä¸šä¿¡æ¯ = pd.read_excel('é™„ä»¶1ï¼š123å®¶æœ‰ä¿¡è´·è®°å½•ä¼ä¸šçš„ç›¸å…³æ•°æ®.xlsx', sheet_name='ä¼ä¸šä¿¡æ¯')
            self.è¿›é¡¹å‘ç¥¨ = pd.read_excel('é™„ä»¶1ï¼š123å®¶æœ‰ä¿¡è´·è®°å½•ä¼ä¸šçš„ç›¸å…³æ•°æ®.xlsx', sheet_name='è¿›é¡¹å‘ç¥¨ä¿¡æ¯')
            self.é”€é¡¹å‘ç¥¨ = pd.read_excel('é™„ä»¶1ï¼š123å®¶æœ‰ä¿¡è´·è®°å½•ä¼ä¸šçš„ç›¸å…³æ•°æ®.xlsx', sheet_name='é”€é¡¹å‘ç¥¨ä¿¡æ¯')
            
            # è¯»å–é™„ä»¶3å®¢æˆ·æµå¤±ç‡æ•°æ®
            self.å®¢æˆ·æµå¤±ç‡æ•°æ® = pd.read_excel('é™„ä»¶3ï¼šé“¶è¡Œè´·æ¬¾å¹´åˆ©ç‡ä¸å®¢æˆ·æµå¤±ç‡å…³ç³»çš„ç»Ÿè®¡æ•°æ®.xlsx')
            
            print(f"âœ… æ•°æ®åŠ è½½æˆåŠŸ:")
            print(f"   - ä¼ä¸šä¿¡æ¯: {len(self.ä¼ä¸šä¿¡æ¯)}å®¶ä¼ä¸š")
            print(f"   - è¿›é¡¹å‘ç¥¨: {len(self.è¿›é¡¹å‘ç¥¨)}æ¡è®°å½•")
            print(f"   - é”€é¡¹å‘ç¥¨: {len(self.é”€é¡¹å‘ç¥¨)}æ¡è®°å½•")
            print(f"   - å®¢æˆ·æµå¤±ç‡æ•°æ®: {len(self.å®¢æˆ·æµå¤±ç‡æ•°æ®)}æ¡è®°å½•")
            
            # æ˜¾ç¤ºå®¢æˆ·æµå¤±ç‡æ•°æ®ç»“æ„
            print(f"\nğŸ“ˆ å®¢æˆ·æµå¤±ç‡æ•°æ®é¢„è§ˆ:")
            print(self.å®¢æˆ·æµå¤±ç‡æ•°æ®.head())
            
            return True
        except Exception as e:
            print(f"âŒ æ•°æ®åŠ è½½å¤±è´¥: {e}")
            return False
    
    def analyze_invoice_features(self):
        """åˆ†æå‘ç¥¨ç‰¹å¾ï¼Œæ„å»ºè´¢åŠ¡æŒ‡æ ‡"""
        print("\nğŸ” åˆ†æå‘ç¥¨æ•°æ®ï¼Œæ„å»ºè´¢åŠ¡ç‰¹å¾...")
        
        # è¿›é¡¹å‘ç¥¨æ±‡æ€»
        è¿›é¡¹æ±‡æ€» = self.è¿›é¡¹å‘ç¥¨.groupby('ä¼ä¸šä»£å·').agg({
            'ä»·ç¨åˆè®¡': ['sum', 'count', 'mean', 'std'],
            'é‡‘é¢': 'sum',
            'ç¨é¢': 'sum',
            'å‘ç¥¨çŠ¶æ€': lambda x: (x == 'ä½œåºŸå‘ç¥¨').sum()
        })
        è¿›é¡¹æ±‡æ€».columns = ['è¿›é¡¹æ€»é¢', 'è¿›é¡¹å‘ç¥¨æ•°', 'è¿›é¡¹å¹³å‡é¢', 'è¿›é¡¹æ ‡å‡†å·®', 'è¿›é¡¹å‡€é¢', 'è¿›é¡¹ç¨é¢', 'è¿›é¡¹ä½œåºŸæ•°']
        è¿›é¡¹æ±‡æ€»['è¿›é¡¹ä½œåºŸç‡'] = è¿›é¡¹æ±‡æ€»['è¿›é¡¹ä½œåºŸæ•°'] / è¿›é¡¹æ±‡æ€»['è¿›é¡¹å‘ç¥¨æ•°']
        
        # é”€é¡¹å‘ç¥¨æ±‡æ€»
        é”€é¡¹æ±‡æ€» = self.é”€é¡¹å‘ç¥¨.groupby('ä¼ä¸šä»£å·').agg({
            'ä»·ç¨åˆè®¡': ['sum', 'count', 'mean', 'std'],
            'é‡‘é¢': 'sum',
            'ç¨é¢': 'sum',
            'å‘ç¥¨çŠ¶æ€': lambda x: (x.str.strip() == 'ä½œåºŸå‘ç¥¨').sum()
        })
        é”€é¡¹æ±‡æ€».columns = ['é”€é¡¹æ€»é¢', 'é”€é¡¹å‘ç¥¨æ•°', 'é”€é¡¹å¹³å‡é¢', 'é”€é¡¹æ ‡å‡†å·®', 'é”€é¡¹å‡€é¢', 'é”€é¡¹ç¨é¢', 'é”€é¡¹ä½œåºŸæ•°']
        é”€é¡¹æ±‡æ€»['é”€é¡¹ä½œåºŸç‡'] = é”€é¡¹æ±‡æ€»['é”€é¡¹ä½œåºŸæ•°'] / é”€é¡¹æ±‡æ€»['é”€é¡¹å‘ç¥¨æ•°']
        
        # åˆå¹¶ä¼ä¸šä¿¡æ¯å’Œå‘ç¥¨æ•°æ®
        self.ç»¼åˆæ•°æ® = self.ä¼ä¸šä¿¡æ¯.set_index('ä¼ä¸šä»£å·').join([è¿›é¡¹æ±‡æ€», é”€é¡¹æ±‡æ€»], how='left')
        self.ç»¼åˆæ•°æ® = self.ç»¼åˆæ•°æ®.fillna(0)
        
        # è®¡ç®—å…³é”®è´¢åŠ¡æŒ‡æ ‡
        self._calculate_financial_indicators()
        
        print("âœ… å‘ç¥¨ç‰¹å¾åˆ†æå®Œæˆ")
        
    def _calculate_financial_indicators(self):
        """è®¡ç®—è´¢åŠ¡å’Œé£é™©æŒ‡æ ‡"""
        
        # 1. ç›ˆåˆ©èƒ½åŠ›æŒ‡æ ‡
        self.ç»¼åˆæ•°æ®['æ¯›åˆ©æ¶¦'] = self.ç»¼åˆæ•°æ®['é”€é¡¹å‡€é¢'] - self.ç»¼åˆæ•°æ®['è¿›é¡¹å‡€é¢']
        self.ç»¼åˆæ•°æ®['æ¯›åˆ©ç‡'] = self.ç»¼åˆæ•°æ®['æ¯›åˆ©æ¶¦'] / (self.ç»¼åˆæ•°æ®['é”€é¡¹å‡€é¢'] + 1e-6)
        
        # 2. ä¸šåŠ¡è§„æ¨¡æŒ‡æ ‡
        self.ç»¼åˆæ•°æ®['è¥ä¸šæ”¶å…¥'] = self.ç»¼åˆæ•°æ®['é”€é¡¹å‡€é¢']
        self.ç»¼åˆæ•°æ®['ä¸šåŠ¡è§„æ¨¡'] = np.log1p(self.ç»¼åˆæ•°æ®['é”€é¡¹æ€»é¢'] + self.ç»¼åˆæ•°æ®['è¿›é¡¹æ€»é¢'])
        
        # 3. ä¸šåŠ¡æ´»è·ƒåº¦æŒ‡æ ‡
        self.ç»¼åˆæ•°æ®['æ€»å‘ç¥¨æ•°'] = self.ç»¼åˆæ•°æ®['è¿›é¡¹å‘ç¥¨æ•°'] + self.ç»¼åˆæ•°æ®['é”€é¡¹å‘ç¥¨æ•°']
        self.ç»¼åˆæ•°æ®['å‘ç¥¨æ´»è·ƒåº¦'] = np.log1p(self.ç»¼åˆæ•°æ®['æ€»å‘ç¥¨æ•°'])
        
        # 4. å‘ç¥¨è´¨é‡æŒ‡æ ‡
        self.ç»¼åˆæ•°æ®['æ€»ä½œåºŸæ•°'] = self.ç»¼åˆæ•°æ®['è¿›é¡¹ä½œåºŸæ•°'] + self.ç»¼åˆæ•°æ®['é”€é¡¹ä½œåºŸæ•°']
        self.ç»¼åˆæ•°æ®['æ•´ä½“ä½œåºŸç‡'] = self.ç»¼åˆæ•°æ®['æ€»ä½œåºŸæ•°'] / (self.ç»¼åˆæ•°æ®['æ€»å‘ç¥¨æ•°'] + 1e-6)
        
        # 5. ç°é‡‘æµæŒ‡æ ‡
        self.ç»¼åˆæ•°æ®['å‡€ç°é‡‘æµ'] = self.ç»¼åˆæ•°æ®['é”€é¡¹æ€»é¢'] - self.ç»¼åˆæ•°æ®['è¿›é¡¹æ€»é¢']
        self.ç»¼åˆæ•°æ®['ç°é‡‘æµæ¯”ç‡'] = self.ç»¼åˆæ•°æ®['å‡€ç°é‡‘æµ'] / (self.ç»¼åˆæ•°æ®['é”€é¡¹æ€»é¢'] + 1e-6)
        
        # 6. ä¸šåŠ¡ç¨³å®šæ€§æŒ‡æ ‡
        self.ç»¼åˆæ•°æ®['æ”¶å…¥ç¨³å®šæ€§'] = 1 / (self.ç»¼åˆæ•°æ®['é”€é¡¹æ ‡å‡†å·®'] / (self.ç»¼åˆæ•°æ®['é”€é¡¹å¹³å‡é¢'] + 1e-6) + 1)
        self.ç»¼åˆæ•°æ®['æ”¯å‡ºç¨³å®šæ€§'] = 1 / (self.ç»¼åˆæ•°æ®['è¿›é¡¹æ ‡å‡†å·®'] / (self.ç»¼åˆæ•°æ®['è¿›é¡¹å¹³å‡é¢'] + 1e-6) + 1)
        
        # 7. ä¿¡èª‰è¯„çº§æ•°å€¼åŒ–
        rating_map = {'A': 1, 'B': 2, 'C': 3, 'D': 4}
        self.ç»¼åˆæ•°æ®['ä¿¡èª‰è¯„çº§æ•°å€¼'] = self.ç»¼åˆæ•°æ®['ä¿¡èª‰è¯„çº§'].map(rating_map)
        
        # 8. è¿çº¦æ ‡ç­¾
        self.ç»¼åˆæ•°æ®['è¿çº¦æ ‡ç­¾'] = (self.ç»¼åˆæ•°æ®['æ˜¯å¦è¿çº¦'] == 'æ˜¯').astype(int)
    
    def build_risk_model(self):
        """æ„å»ºå¤šç»´åº¦ä¿¡è´·é£é™©è¯„åˆ†æ¨¡å‹"""
        print("\nğŸ§® æ„å»ºå¤šç»´åº¦ä¿¡è´·é£é™©è¯„åˆ†æ¨¡å‹...")
        
        # å®šä¹‰é£é™©è¯„åˆ†ç»´åº¦å’Œæƒé‡
        risk_weights = {
            'ä¿¡èª‰è¯„çº§æƒé‡': 0.35,
            'å†å²è¿çº¦æƒé‡': 0.25,
            'è´¢åŠ¡çŠ¶å†µæƒé‡': 0.20,
            'å‘ç¥¨è´¨é‡æƒé‡': 0.15,
            'ä¸šåŠ¡ç¨³å®šæƒé‡': 0.05
        }
        
        # 1. ä¿¡èª‰è¯„çº§é£é™©è¯„åˆ† (0-1, è¶Šé«˜é£é™©è¶Šå¤§)
        rating_risk_map = {'A': 0.1, 'B': 0.3, 'C': 0.6, 'D': 0.9}
        self.ç»¼åˆæ•°æ®['ä¿¡èª‰é£é™©è¯„åˆ†'] = self.ç»¼åˆæ•°æ®['ä¿¡èª‰è¯„çº§'].map(rating_risk_map)
        
        # 2. å†å²è¿çº¦é£é™©è¯„åˆ†
        self.ç»¼åˆæ•°æ®['è¿çº¦é£é™©è¯„åˆ†'] = self.ç»¼åˆæ•°æ®['è¿çº¦æ ‡ç­¾'] * 0.8 + (1 - self.ç»¼åˆæ•°æ®['è¿çº¦æ ‡ç­¾']) * 0.1
        
        # 3. è´¢åŠ¡çŠ¶å†µé£é™©è¯„åˆ† (åŸºäºæ¯›åˆ©ç‡ï¼Œæ ‡å‡†åŒ–åå–å)
        æ¯›åˆ©ç‡_min = self.ç»¼åˆæ•°æ®['æ¯›åˆ©ç‡'].min()
        æ¯›åˆ©ç‡_max = self.ç»¼åˆæ•°æ®['æ¯›åˆ©ç‡'].max()
        self.ç»¼åˆæ•°æ®['è´¢åŠ¡é£é™©è¯„åˆ†'] = 1 - (self.ç»¼åˆæ•°æ®['æ¯›åˆ©ç‡'] - æ¯›åˆ©ç‡_min) / (æ¯›åˆ©ç‡_max - æ¯›åˆ©ç‡_min + 1e-6)
        
        # 4. å‘ç¥¨è´¨é‡é£é™©è¯„åˆ†
        self.ç»¼åˆæ•°æ®['å‘ç¥¨é£é™©è¯„åˆ†'] = self.ç»¼åˆæ•°æ®['æ•´ä½“ä½œåºŸç‡']
        
        # 5. ä¸šåŠ¡ç¨³å®šæ€§é£é™©è¯„åˆ† (åŸºäºå‘ç¥¨æ´»è·ƒåº¦ï¼Œæ ‡å‡†åŒ–åå–å)
        æ´»è·ƒåº¦_min = self.ç»¼åˆæ•°æ®['å‘ç¥¨æ´»è·ƒåº¦'].min()
        æ´»è·ƒåº¦_max = self.ç»¼åˆæ•°æ®['å‘ç¥¨æ´»è·ƒåº¦'].max()
        self.ç»¼åˆæ•°æ®['ç¨³å®šé£é™©è¯„åˆ†'] = 1 - (self.ç»¼åˆæ•°æ®['å‘ç¥¨æ´»è·ƒåº¦'] - æ´»è·ƒåº¦_min) / (æ´»è·ƒåº¦_max - æ´»è·ƒåº¦_min + 1e-6)
        
        # ç»¼åˆé£é™©è¯„åˆ† (åŠ æƒå¹³å‡)
        self.ç»¼åˆæ•°æ®['ç»¼åˆé£é™©è¯„åˆ†'] = (
            risk_weights['ä¿¡èª‰è¯„çº§æƒé‡'] * self.ç»¼åˆæ•°æ®['ä¿¡èª‰é£é™©è¯„åˆ†'] +
            risk_weights['å†å²è¿çº¦æƒé‡'] * self.ç»¼åˆæ•°æ®['è¿çº¦é£é™©è¯„åˆ†'] +
            risk_weights['è´¢åŠ¡çŠ¶å†µæƒé‡'] * self.ç»¼åˆæ•°æ®['è´¢åŠ¡é£é™©è¯„åˆ†'] +
            risk_weights['å‘ç¥¨è´¨é‡æƒé‡'] * self.ç»¼åˆæ•°æ®['å‘ç¥¨é£é™©è¯„åˆ†'] +
            risk_weights['ä¸šåŠ¡ç¨³å®šæƒé‡'] * self.ç»¼åˆæ•°æ®['ç¨³å®šé£é™©è¯„åˆ†']
        )
        
        # é£é™©ç­‰çº§åˆ†ç±»
        def classify_risk_level(score):
            if score <= 0.3:
                return 'ä½é£é™©'
            elif score <= 0.5:
                return 'ä¸­ä½é£é™©'
            elif score <= 0.7:
                return 'ä¸­é«˜é£é™©'
            else:
                return 'é«˜é£é™©'
        
        self.ç»¼åˆæ•°æ®['é£é™©ç­‰çº§'] = self.ç»¼åˆæ•°æ®['ç»¼åˆé£é™©è¯„åˆ†'].apply(classify_risk_level)
        
        print("âœ… é£é™©æ¨¡å‹æ„å»ºå®Œæˆ")
        
        # æ˜¾ç¤ºé£é™©æƒé‡è®¾ç½®
        print(f"\nğŸ“Š é£é™©è¯„åˆ†æƒé‡è®¾ç½®:")
        for key, value in risk_weights.items():
            print(f"   {key}: {value}")
    
    def design_credit_strategy(self, total_budget=10000):
        """è®¾è®¡ä¿¡è´·ç­–ç•¥"""
        print(f"\nğŸ’° è®¾è®¡ä¿¡è´·ç­–ç•¥ (æ€»é¢„ç®—: {total_budget}ä¸‡å…ƒ)...")
        
        # 1. åŸºç¡€è´·æ¬¾é¢åº¦è®¡ç®— (åŸºäºä¿¡èª‰è¯„çº§å’Œè¥ä¸šæ”¶å…¥)
        def calculate_base_amount(row):
            rating = row['ä¿¡èª‰è¯„çº§']
            income = row['è¥ä¸šæ”¶å…¥']
            has_default = row['è¿çº¦æ ‡ç­¾']
            
            # Dçº§ä¼ä¸šåŸåˆ™ä¸Šä¸æ”¾è´·
            if rating == 'D':
                return 0
            
            # æ ¹æ®ä¿¡èª‰è¯„çº§ç¡®å®šæ”¶å…¥æ¯”ä¾‹
            income_ratios = {
                ('A', 0): 0.25,  # Açº§æ— è¿çº¦
                ('A', 1): 0.15,  # Açº§æœ‰è¿çº¦
                ('B', 0): 0.20,  # Bçº§æ— è¿çº¦
                ('B', 1): 0.12,  # Bçº§æœ‰è¿çº¦
                ('C', 0): 0.10,  # Cçº§æ— è¿çº¦
                ('C', 1): 0.08,  # Cçº§æœ‰è¿çº¦
            }
            
            ratio = income_ratios.get((rating, has_default), 0.05)
            base_amount = income * ratio
            
            # é¢åº¦ä¸Šé™
            max_amounts = {
                ('A', 0): 100,
                ('A', 1): 80,
                ('B', 0): 80,
                ('B', 1): 60,
                ('C', 0): 50,
                ('C', 1): 30,
            }
            
            max_amount = max_amounts.get((rating, has_default), 0)
            
            return min(max_amount, max(10, base_amount)) if base_amount >= 10 else 0
        
        self.ç»¼åˆæ•°æ®['åŸºç¡€é¢åº¦'] = self.ç»¼åˆæ•°æ®.apply(calculate_base_amount, axis=1)
        
        # 2. è´¢åŠ¡çŠ¶å†µè°ƒæ•´
        def adjust_by_financial(row):
            base = row['åŸºç¡€é¢åº¦']
            if base == 0:
                return 0
            
            profit_margin = row['æ¯›åˆ©ç‡']
            if profit_margin > 0.3:
                return min(100, base * 1.2)
            elif profit_margin < 0:
                return base * 0.7
            else:
                return base
        
        self.ç»¼åˆæ•°æ®['è°ƒæ•´é¢åº¦'] = self.ç»¼åˆæ•°æ®.apply(adjust_by_financial, axis=1)
        
        # 3. æœ€ç»ˆé¢åº¦ç¡®å®š (10-100ä¸‡å…ƒ)
        self.ç»¼åˆæ•°æ®['æ¨èé¢åº¦'] = self.ç»¼åˆæ•°æ®['è°ƒæ•´é¢åº¦'].apply(
            lambda x: min(100, max(10, x)) if x >= 10 else 0
        )
        
        # 4. åˆ©ç‡å®šä»· (ç»“åˆå®¢æˆ·æµå¤±ç‡ä¼˜åŒ–)
        self._calculate_optimal_interest_rates()
        
        # 5. é¢„ç®—åˆ†é…ä¼˜åŒ–
        self._optimize_budget_allocation(total_budget)
        
        print("âœ… ä¿¡è´·ç­–ç•¥è®¾è®¡å®Œæˆ")
    
    def _calculate_optimal_interest_rates(self):
        """ç»“åˆå®¢æˆ·æµå¤±ç‡æ•°æ®è®¡ç®—æœ€ä¼˜åˆ©ç‡"""
        print("\nğŸ¯ ç»“åˆå®¢æˆ·æµå¤±ç‡ä¼˜åŒ–åˆ©ç‡å®šä»·...")
        
        def calculate_interest_rate(row):
            rating = row['ä¿¡èª‰è¯„çº§']
            risk_score = row['ç»¼åˆé£é™©è¯„åˆ†']
            has_default = row['è¿çº¦æ ‡ç­¾']
            
            if row['æ¨èé¢åº¦'] == 0:
                return 0
            
            # åŸºç¡€åˆ©ç‡
            base_rates = {
                ('A', 0): 0.045,
                ('A', 1): 0.055,
                ('B', 0): 0.055,
                ('B', 1): 0.070,
                ('C', 0): 0.080,
                ('C', 1): 0.100,
            }
            
            base_rate = base_rates.get((rating, has_default), 0.12)
            
            # é£é™©è°ƒæ•´
            risk_adjustments = {
                ('A', 0): 0.02,
                ('A', 1): 0.03,
                ('B', 0): 0.03,
                ('B', 1): 0.04,
                ('C', 0): 0.05,
                ('C', 1): 0.05,
            }
            
            risk_adj = risk_adjustments.get((rating, has_default), 0.06)
            initial_rate = base_rate + risk_adj * risk_score
            
            # ç»“åˆå®¢æˆ·æµå¤±ç‡ä¼˜åŒ–åˆ©ç‡
            optimal_rate = self._optimize_rate_with_churn(initial_rate, rating)
            
            # åˆ©ç‡çº¦æŸ: 4%-15%
            return max(0.04, min(0.15, optimal_rate))
        
        self.ç»¼åˆæ•°æ®['æ¨èåˆ©ç‡'] = self.ç»¼åˆæ•°æ®.apply(calculate_interest_rate, axis=1)
    
    def _optimize_rate_with_churn(self, initial_rate, rating):
        """æ ¹æ®å®¢æˆ·æµå¤±ç‡æ•°æ®ä¼˜åŒ–åˆ©ç‡"""
        
        # ä»é™„ä»¶3æ•°æ®ä¸­æ‰¾åˆ°æœ€æ¥è¿‘çš„åˆ©ç‡åŒºé—´
        rates = self.å®¢æˆ·æµå¤±ç‡æ•°æ®.iloc[:, 0].values  # ç¬¬ä¸€åˆ—æ˜¯åˆ©ç‡
        churn_rates = self.å®¢æˆ·æµå¤±ç‡æ•°æ®.iloc[:, 1].values  # ç¬¬äºŒåˆ—æ˜¯æµå¤±ç‡
        
        # è®¡ç®—ä¸åŒåˆ©ç‡ä¸‹çš„é¢„æœŸæ”¶ç›Š (è€ƒè™‘å®¢æˆ·æµå¤±)
        best_rate = initial_rate
        best_net_return = 0
        
        # åœ¨åˆå§‹åˆ©ç‡é™„è¿‘æœç´¢æœ€ä¼˜åˆ©ç‡
        search_range = np.linspace(max(0.04, initial_rate - 0.02), 
                                 min(0.15, initial_rate + 0.02), 20)
        
        for test_rate in search_range:
            # æ’å€¼è®¡ç®—è¯¥åˆ©ç‡å¯¹åº”çš„å®¢æˆ·æµå¤±ç‡
            if test_rate <= rates.min():
                churn_rate = churn_rates[0]
            elif test_rate >= rates.max():
                churn_rate = churn_rates[-1]
            else:
                churn_rate = np.interp(test_rate, rates, churn_rates)
            
            # å®¢æˆ·ä¿ç•™ç‡
            retention_rate = 1 - churn_rate / 100
            
            # è®¡ç®—å‡€æ”¶ç›Š = åˆ©ç‡ Ã— å®¢æˆ·ä¿ç•™ç‡
            net_return = test_rate * retention_rate
            
            if net_return > best_net_return:
                best_net_return = net_return
                best_rate = test_rate
        
        return best_rate
    
    def _optimize_budget_allocation(self, total_budget):
        """é¢„ç®—åˆ†é…ä¼˜åŒ– (è€ƒè™‘å®¢æˆ·æµå¤±ç‡)"""
        
        # è®¡ç®—æ¯ä¸ªä¼ä¸šçš„å®¢æˆ·æµå¤±ç‡
        rates = self.å®¢æˆ·æµå¤±ç‡æ•°æ®.iloc[:, 0].values
        churn_rates = self.å®¢æˆ·æµå¤±ç‡æ•°æ®.iloc[:, 1].values
        
        def get_churn_rate(interest_rate):
            if interest_rate <= rates.min():
                return churn_rates[0] / 100
            elif interest_rate >= rates.max():
                return churn_rates[-1] / 100
            else:
                return np.interp(interest_rate, rates, churn_rates) / 100
        
        self.ç»¼åˆæ•°æ®['å®¢æˆ·æµå¤±ç‡'] = self.ç»¼åˆæ•°æ®['æ¨èåˆ©ç‡'].apply(get_churn_rate)
        self.ç»¼åˆæ•°æ®['å®¢æˆ·ä¿ç•™ç‡'] = 1 - self.ç»¼åˆæ•°æ®['å®¢æˆ·æµå¤±ç‡']
        
        # è®¡ç®—é¢„æœŸæ”¶ç›Š (è€ƒè™‘è¿çº¦é£é™©å’Œå®¢æˆ·æµå¤±)
        self.ç»¼åˆæ•°æ®['è¿çº¦æ¦‚ç‡'] = np.minimum(0.95, self.ç»¼åˆæ•°æ®['ç»¼åˆé£é™©è¯„åˆ†'] * 1.1)
        self.ç»¼åˆæ•°æ®['é¢„æœŸæ”¶ç›Š'] = (
            self.ç»¼åˆæ•°æ®['æ¨èé¢åº¦'] * 
            self.ç»¼åˆæ•°æ®['æ¨èåˆ©ç‡'] * 
            (1 - self.ç»¼åˆæ•°æ®['è¿çº¦æ¦‚ç‡']) *
            self.ç»¼åˆæ•°æ®['å®¢æˆ·ä¿ç•™ç‡']  # æ–°å¢å®¢æˆ·ä¿ç•™ç‡å› å­
        )
        
        # é£é™©è°ƒæ•´æ”¶ç›Šç‡
        self.ç»¼åˆæ•°æ®['é£é™©è°ƒæ•´æ”¶ç›Šç‡'] = (
            self.ç»¼åˆæ•°æ®['é¢„æœŸæ”¶ç›Š'] / 
            (self.ç»¼åˆæ•°æ®['æ¨èé¢åº¦'] * self.ç»¼åˆæ•°æ®['ç»¼åˆé£é™©è¯„åˆ†'] + 0.01)
        )
        
        # æŒ‰é£é™©è°ƒæ•´æ”¶ç›Šç‡æ’åºï¼Œä¼˜å…ˆåˆ†é…é«˜æ”¶ç›Šä½é£é™©ä¼ä¸š
        å€™é€‰ä¼ä¸š = self.ç»¼åˆæ•°æ®[self.ç»¼åˆæ•°æ®['æ¨èé¢åº¦'] > 0].copy()
        å€™é€‰ä¼ä¸š = å€™é€‰ä¼ä¸š.sort_values('é£é™©è°ƒæ•´æ”¶ç›Šç‡', ascending=False)
        
        # é¢„ç®—åˆ†é…
        ç´¯è®¡é¢„ç®— = 0
        æœ€ç»ˆé¢åº¦ = []
        
        for idx, row in å€™é€‰ä¼ä¸š.iterrows():
            æ¨èé¢åº¦ = row['æ¨èé¢åº¦']
            
            if ç´¯è®¡é¢„ç®— + æ¨èé¢åº¦ <= total_budget:
                æœ€ç»ˆé¢åº¦.append(æ¨èé¢åº¦)
                ç´¯è®¡é¢„ç®— += æ¨èé¢åº¦
            elif total_budget - ç´¯è®¡é¢„ç®— >= 10:  # å‰©ä½™é¢„ç®—å¤Ÿæœ€å°é¢åº¦
                å‰©ä½™é¢åº¦ = total_budget - ç´¯è®¡é¢„ç®—
                æœ€ç»ˆé¢åº¦.append(å‰©ä½™é¢åº¦)
                ç´¯è®¡é¢„ç®— = total_budget
            else:
                æœ€ç»ˆé¢åº¦.append(0)
        
        å€™é€‰ä¼ä¸š['æœ€ç»ˆé¢åº¦'] = æœ€ç»ˆé¢åº¦
        
        # æ›´æ–°ç»¼åˆæ•°æ®
        self.ç»¼åˆæ•°æ®['æœ€ç»ˆé¢åº¦'] = 0
        self.ç»¼åˆæ•°æ®.loc[å€™é€‰ä¼ä¸š.index, 'æœ€ç»ˆé¢åº¦'] = å€™é€‰ä¼ä¸š['æœ€ç»ˆé¢åº¦']
        
        # æ›´æ–°è´·æ¬¾å†³ç­–
        self.ç»¼åˆæ•°æ®['è´·æ¬¾å†³ç­–'] = self.ç»¼åˆæ•°æ®['æœ€ç»ˆé¢åº¦'].apply(
            lambda x: 'æ‰¹å‡†' if x > 0 else 'æ‹’ç»'
        )
        
        # è®¡ç®—æœ€ç»ˆæ”¶ç›Š (è€ƒè™‘å®¢æˆ·æµå¤±)
        self.ç»¼åˆæ•°æ®['æœ€ç»ˆæ”¶ç›Š'] = (
            self.ç»¼åˆæ•°æ®['æœ€ç»ˆé¢åº¦'] * 
            self.ç»¼åˆæ•°æ®['æ¨èåˆ©ç‡'] * 
            (1 - self.ç»¼åˆæ•°æ®['è¿çº¦æ¦‚ç‡']) *
            self.ç»¼åˆæ•°æ®['å®¢æˆ·ä¿ç•™ç‡']
        )
    
    def generate_analysis_report(self):
        """ç”Ÿæˆåˆ†ææŠ¥å‘Š"""
        print("\n" + "="*80)
        print("ğŸ“Š é—®é¢˜1ï¼š123å®¶ä¼ä¸šä¿¡è´·é£é™©é‡åŒ–åˆ†ææŠ¥å‘Š")
        print("="*80)
        
        # åŸºæœ¬ç»Ÿè®¡
        print(f"\nğŸ“ˆ åŸºæœ¬ç»Ÿè®¡ä¿¡æ¯:")
        print(f"   ä¼ä¸šæ€»æ•°: {len(self.ç»¼åˆæ•°æ®)}å®¶")
        print(f"   æœ‰æ•ˆä¼ä¸š: {len(self.ç»¼åˆæ•°æ®[self.ç»¼åˆæ•°æ®['è¥ä¸šæ”¶å…¥'] > 0])}å®¶")
        
        # ä¿¡èª‰è¯„çº§åˆ†å¸ƒ
        print(f"\nâ­ ä¿¡èª‰è¯„çº§åˆ†å¸ƒ:")
        rating_dist = self.ç»¼åˆæ•°æ®['ä¿¡èª‰è¯„çº§'].value_counts().sort_index()
        for rating, count in rating_dist.items():
            percentage = count / len(self.ç»¼åˆæ•°æ®) * 100
            print(f"   {rating}çº§: {count:2d}å®¶ ({percentage:5.1f}%)")
        
        # è¿çº¦æƒ…å†µ
        print(f"\nâš ï¸ å†å²è¿çº¦æƒ…å†µ:")
        default_stats = self.ç»¼åˆæ•°æ®.groupby('ä¿¡èª‰è¯„çº§')['è¿çº¦æ ‡ç­¾'].agg(['count', 'sum', 'mean'])
        for rating, stats in default_stats.iterrows():
            è¿çº¦ç‡ = stats['mean'] * 100
            print(f"   {rating}çº§: {stats['sum']:2.0f}/{stats['count']:2.0f} = {è¿çº¦ç‡:5.1f}%")
        
        # é£é™©ç­‰çº§åˆ†å¸ƒ
        print(f"\nğŸ“Š ç»¼åˆé£é™©ç­‰çº§åˆ†å¸ƒ:")
        risk_dist = self.ç»¼åˆæ•°æ®['é£é™©ç­‰çº§'].value_counts()
        for level, count in risk_dist.items():
            percentage = count / len(self.ç»¼åˆæ•°æ®) * 100
            print(f"   {level}: {count:2d}å®¶ ({percentage:5.1f}%)")
        
        # ä¿¡è´·ç­–ç•¥ç»“æœ
        print(f"\nğŸ’° ä¿¡è´·ç­–ç•¥ç»“æœ:")
        æ‰¹å‡†ä¼ä¸š = self.ç»¼åˆæ•°æ®[self.ç»¼åˆæ•°æ®['æœ€ç»ˆé¢åº¦'] > 0]
        æ‹’ç»ä¼ä¸š = self.ç»¼åˆæ•°æ®[self.ç»¼åˆæ•°æ®['æœ€ç»ˆé¢åº¦'] == 0]
        
        print(f"   æ‰¹å‡†æ”¾è´·: {len(æ‰¹å‡†ä¼ä¸š)}å®¶ ({len(æ‰¹å‡†ä¼ä¸š)/len(self.ç»¼åˆæ•°æ®)*100:.1f}%)")
        print(f"   æ‹’ç»æ”¾è´·: {len(æ‹’ç»ä¼ä¸š)}å®¶ ({len(æ‹’ç»ä¼ä¸š)/len(self.ç»¼åˆæ•°æ®)*100:.1f}%)")
        print(f"   æ€»æ”¾è´·é‡‘é¢: {æ‰¹å‡†ä¼ä¸š['æœ€ç»ˆé¢åº¦'].sum():,.0f}ä¸‡å…ƒ")
        print(f"   å¹³å‡è´·æ¬¾é¢åº¦: {æ‰¹å‡†ä¼ä¸š['æœ€ç»ˆé¢åº¦'].mean():.1f}ä¸‡å…ƒ")
        print(f"   åŠ æƒå¹³å‡åˆ©ç‡: {(æ‰¹å‡†ä¼ä¸š['æœ€ç»ˆé¢åº¦'] * æ‰¹å‡†ä¼ä¸š['æ¨èåˆ©ç‡']).sum() / æ‰¹å‡†ä¼ä¸š['æœ€ç»ˆé¢åº¦'].sum() * 100:.2f}%")
        
        # æ”¶ç›Šåˆ†æ
        æ€»æ”¶ç›Š = æ‰¹å‡†ä¼ä¸š['æœ€ç»ˆæ”¶ç›Š'].sum()
        æ€»æŠ•èµ„ = æ‰¹å‡†ä¼ä¸š['æœ€ç»ˆé¢åº¦'].sum()
        æŠ•èµ„å›æŠ¥ç‡ = æ€»æ”¶ç›Š / æ€»æŠ•èµ„ * 100 if æ€»æŠ•èµ„ > 0 else 0
        
        print(f"\nğŸ“ˆ æ”¶ç›Šåˆ†æ:")
        print(f"   é¢„æœŸå¹´æ”¶ç›Š: {æ€»æ”¶ç›Š:.1f}ä¸‡å…ƒ")
        print(f"   æŠ•èµ„å›æŠ¥ç‡: {æŠ•èµ„å›æŠ¥ç‡:.2f}%")
        print(f"   å¹³å‡è¿çº¦æ¦‚ç‡: {æ‰¹å‡†ä¼ä¸š['è¿çº¦æ¦‚ç‡'].mean()*100:.2f}%")
        
        # å„ç­‰çº§æ”¾è´·æƒ…å†µ
        print(f"\nğŸ“‹ å„ä¿¡èª‰ç­‰çº§æ”¾è´·æƒ…å†µ:")
        for rating in ['A', 'B', 'C', 'D']:
            rating_data = self.ç»¼åˆæ•°æ®[self.ç»¼åˆæ•°æ®['ä¿¡èª‰è¯„çº§'] == rating]
            if len(rating_data) > 0:
                æ‰¹å‡†æ•° = len(rating_data[rating_data['æœ€ç»ˆé¢åº¦'] > 0])
                æ€»æ•° = len(rating_data)
                æ‰¹å‡†ç‡ = æ‰¹å‡†æ•° / æ€»æ•° * 100
                å¹³å‡é¢åº¦ = rating_data[rating_data['æœ€ç»ˆé¢åº¦'] > 0]['æœ€ç»ˆé¢åº¦'].mean()
                å¹³å‡åˆ©ç‡ = rating_data[rating_data['æœ€ç»ˆé¢åº¦'] > 0]['æ¨èåˆ©ç‡'].mean() * 100
                
                print(f"   {rating}çº§: {æ‰¹å‡†æ•°}/{æ€»æ•°} ({æ‰¹å‡†ç‡:.1f}%), "
                      f"å¹³å‡é¢åº¦{å¹³å‡é¢åº¦:.1f}ä¸‡å…ƒ, å¹³å‡åˆ©ç‡{å¹³å‡åˆ©ç‡:.2f}%")
        
        print("\n" + "="*80)
    
    def export_results(self):
        """å¯¼å‡ºåˆ†æç»“æœ"""
        # é€‰æ‹©å…³é”®å­—æ®µå¯¼å‡º (åŒ…å«å®¢æˆ·æµå¤±ç‡ç›¸å…³å­—æ®µ)
        export_columns = [
            'ä¼ä¸šä»£å·', 'ä¿¡èª‰è¯„çº§', 'æ˜¯å¦è¿çº¦', 'è¥ä¸šæ”¶å…¥', 'æ¯›åˆ©ç‡',
            'å‘ç¥¨æ´»è·ƒåº¦', 'æ•´ä½“ä½œåºŸç‡', 'ç»¼åˆé£é™©è¯„åˆ†', 'é£é™©ç­‰çº§',
            'æ¨èé¢åº¦', 'æœ€ç»ˆé¢åº¦', 'æ¨èåˆ©ç‡', 'å®¢æˆ·æµå¤±ç‡', 'å®¢æˆ·ä¿ç•™ç‡',
            'è¿çº¦æ¦‚ç‡', 'æœ€ç»ˆæ”¶ç›Š', 'è´·æ¬¾å†³ç­–'
        ]
        
        ç»“æœæ•°æ® = self.ç»¼åˆæ•°æ®.reset_index()[export_columns].round(4)
        
        # å¯¼å‡ºExcel
        with pd.ExcelWriter('é—®é¢˜1_ä¿¡è´·é£é™©åˆ†æç»“æœ_å«å®¢æˆ·æµå¤±ç‡.xlsx') as writer:
            ç»“æœæ•°æ®.to_excel(writer, sheet_name='ä¿¡è´·ç­–ç•¥ç»“æœ', index=False)
            
            # ç»Ÿè®¡æ±‡æ€» (åŒ…å«å®¢æˆ·æµå¤±ç‡åˆ†æ)
            æ‰¹å‡†ä¼ä¸š = self.ç»¼åˆæ•°æ®[self.ç»¼åˆæ•°æ®['æœ€ç»ˆé¢åº¦'] > 0]
            ç»Ÿè®¡æ±‡æ€» = pd.DataFrame({
                'æŒ‡æ ‡': ['ä¼ä¸šæ€»æ•°', 'æ‰¹å‡†ä¼ä¸šæ•°', 'æ‹’ç»ä¼ä¸šæ•°', 'æ‰¹å‡†ç‡(%)', 
                        'æ€»æ”¾è´·é‡‘é¢(ä¸‡å…ƒ)', 'å¹³å‡è´·æ¬¾é¢åº¦(ä¸‡å…ƒ)', 'åŠ æƒå¹³å‡åˆ©ç‡(%)',
                        'å¹³å‡å®¢æˆ·æµå¤±ç‡(%)', 'å¹³å‡å®¢æˆ·ä¿ç•™ç‡(%)', 'æ€»å®¢æˆ·ä¿ç•™ä»·å€¼(ä¸‡å…ƒ)',
                        'é¢„æœŸå¹´æ”¶ç›Š(ä¸‡å…ƒ)', 'æŠ•èµ„å›æŠ¥ç‡(%)', 'å¹³å‡è¿çº¦æ¦‚ç‡(%)'],
                'æ•°å€¼': [
                    len(self.ç»¼åˆæ•°æ®),
                    len(æ‰¹å‡†ä¼ä¸š),
                    len(self.ç»¼åˆæ•°æ®) - len(æ‰¹å‡†ä¼ä¸š),
                    len(æ‰¹å‡†ä¼ä¸š) / len(self.ç»¼åˆæ•°æ®) * 100,
                    self.ç»¼åˆæ•°æ®['æœ€ç»ˆé¢åº¦'].sum(),
                    æ‰¹å‡†ä¼ä¸š['æœ€ç»ˆé¢åº¦'].mean(),
                    (æ‰¹å‡†ä¼ä¸š['æœ€ç»ˆé¢åº¦'] * æ‰¹å‡†ä¼ä¸š['æ¨èåˆ©ç‡']).sum() / æ‰¹å‡†ä¼ä¸š['æœ€ç»ˆé¢åº¦'].sum() * 100,
                    æ‰¹å‡†ä¼ä¸š['å®¢æˆ·æµå¤±ç‡'].mean() * 100,
                    æ‰¹å‡†ä¼ä¸š['å®¢æˆ·ä¿ç•™ç‡'].mean() * 100,
                    (æ‰¹å‡†ä¼ä¸š['æœ€ç»ˆé¢åº¦'] * æ‰¹å‡†ä¼ä¸š['å®¢æˆ·ä¿ç•™ç‡']).sum(),
                    self.ç»¼åˆæ•°æ®['æœ€ç»ˆæ”¶ç›Š'].sum(),
                    self.ç»¼åˆæ•°æ®['æœ€ç»ˆæ”¶ç›Š'].sum() / self.ç»¼åˆæ•°æ®['æœ€ç»ˆé¢åº¦'].sum() * 100 if self.ç»¼åˆæ•°æ®['æœ€ç»ˆé¢åº¦'].sum() > 0 else 0,
                    æ‰¹å‡†ä¼ä¸š['è¿çº¦æ¦‚ç‡'].mean() * 100
                ]
            })
            ç»Ÿè®¡æ±‡æ€».to_excel(writer, sheet_name='ç»Ÿè®¡æ±‡æ€»', index=False)
            
            # å®¢æˆ·æµå¤±ç‡åˆ†æè¡¨
            æµå¤±ç‡åˆ†æ = pd.DataFrame({
                'åˆ©ç‡åŒºé—´': ['4%-6%', '6%-8%', '8%-10%', '10%-12%', '12%ä»¥ä¸Š'],
                'ä¼ä¸šæ•°é‡': [
                    len(æ‰¹å‡†ä¼ä¸š[(æ‰¹å‡†ä¼ä¸š['æ¨èåˆ©ç‡'] >= 0.04) & (æ‰¹å‡†ä¼ä¸š['æ¨èåˆ©ç‡'] < 0.06)]),
                    len(æ‰¹å‡†ä¼ä¸š[(æ‰¹å‡†ä¼ä¸š['æ¨èåˆ©ç‡'] >= 0.06) & (æ‰¹å‡†ä¼ä¸š['æ¨èåˆ©ç‡'] < 0.08)]),
                    len(æ‰¹å‡†ä¼ä¸š[(æ‰¹å‡†ä¼ä¸š['æ¨èåˆ©ç‡'] >= 0.08) & (æ‰¹å‡†ä¼ä¸š['æ¨èåˆ©ç‡'] < 0.10)]),
                    len(æ‰¹å‡†ä¼ä¸š[(æ‰¹å‡†ä¼ä¸š['æ¨èåˆ©ç‡'] >= 0.10) & (æ‰¹å‡†ä¼ä¸š['æ¨èåˆ©ç‡'] < 0.12)]),
                    len(æ‰¹å‡†ä¼ä¸š[æ‰¹å‡†ä¼ä¸š['æ¨èåˆ©ç‡'] >= 0.12])
                ],
                'å¹³å‡æµå¤±ç‡(%)': [
                    æ‰¹å‡†ä¼ä¸š[(æ‰¹å‡†ä¼ä¸š['æ¨èåˆ©ç‡'] >= 0.04) & (æ‰¹å‡†ä¼ä¸š['æ¨èåˆ©ç‡'] < 0.06)]['å®¢æˆ·æµå¤±ç‡'].mean() * 100,
                    æ‰¹å‡†ä¼ä¸š[(æ‰¹å‡†ä¼ä¸š['æ¨èåˆ©ç‡'] >= 0.06) & (æ‰¹å‡†ä¼ä¸š['æ¨èåˆ©ç‡'] < 0.08)]['å®¢æˆ·æµå¤±ç‡'].mean() * 100,
                    æ‰¹å‡†ä¼ä¸š[(æ‰¹å‡†ä¼ä¸š['æ¨èåˆ©ç‡'] >= 0.08) & (æ‰¹å‡†ä¼ä¸š['æ¨èåˆ©ç‡'] < 0.10)]['å®¢æˆ·æµå¤±ç‡'].mean() * 100,
                    æ‰¹å‡†ä¼ä¸š[(æ‰¹å‡†ä¼ä¸š['æ¨èåˆ©ç‡'] >= 0.10) & (æ‰¹å‡†ä¼ä¸š['æ¨èåˆ©ç‡'] < 0.12)]['å®¢æˆ·æµå¤±ç‡'].mean() * 100,
                    æ‰¹å‡†ä¼ä¸š[æ‰¹å‡†ä¼ä¸š['æ¨èåˆ©ç‡'] >= 0.12]['å®¢æˆ·æµå¤±ç‡'].mean() * 100
                ]
            })
            æµå¤±ç‡åˆ†æ = æµå¤±ç‡åˆ†æ.fillna(0)  # å¡«å……ç©ºå€¼
            æµå¤±ç‡åˆ†æ.to_excel(writer, sheet_name='å®¢æˆ·æµå¤±ç‡åˆ†æ', index=False)
        
        print(f"âœ… åˆ†æç»“æœå·²å¯¼å‡ºè‡³: é—®é¢˜1_ä¿¡è´·é£é™©åˆ†æç»“æœ_å«å®¢æˆ·æµå¤±ç‡.xlsx")
        print(f"ğŸ“Š åŒ…å«å®¢æˆ·æµå¤±ç‡ä¼˜åŒ–çš„å®Œæ•´ä¿¡è´·ç­–ç•¥åˆ†æ")

def main():
    """ä¸»å‡½æ•°"""
    analyzer = CreditRiskAnalyzer()
    
    # 1. åŠ è½½æ•°æ®
    if not analyzer.load_data():
        return
    
    # 2. åˆ†æå‘ç¥¨ç‰¹å¾
    analyzer.analyze_invoice_features()
    
    # 3. æ„å»ºé£é™©æ¨¡å‹
    analyzer.build_risk_model()
    
    # 4. è®¾è®¡ä¿¡è´·ç­–ç•¥
    analyzer.design_credit_strategy(total_budget=10000)  # å‡è®¾1äº¿å…ƒé¢„ç®—
    
    # 5. ç”ŸæˆæŠ¥å‘Š
    analyzer.generate_analysis_report()
    
    # 6. å¯¼å‡ºç»“æœ
    analyzer.export_results()
    
    print(f"\nğŸ‰ é—®é¢˜1åˆ†æå®Œæˆï¼")
    print(f"ğŸ“Š å·²å¯¹123å®¶ä¼ä¸šè¿›è¡Œä¿¡è´·é£é™©é‡åŒ–åˆ†æ")
    print(f"ğŸ’° å·²åˆ¶å®šå¹´åº¦ä¿¡è´·æ€»é¢å›ºå®šæ—¶çš„ä¿¡è´·ç­–ç•¥")

if __name__ == "__main__":
    main()
