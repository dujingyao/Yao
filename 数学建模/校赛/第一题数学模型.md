# LEDæ˜¾ç¤ºå±é¢œè‰²è½¬æ¢è®¾è®¡ä¸Žæ ¡æ­£ - ç¬¬ä¸€é¢˜æ•°å­¦æ¨¡åž‹

## ðŸ“ é—®é¢˜æè¿°ä¸Žæ•°å­¦å»ºæ¨¡

### é—®é¢˜å®šä¹‰
å°†BT2020è§†é¢‘æºè‰²åŸŸæ˜ å°„åˆ°æ ‡å‡†æ˜¾ç¤ºå™¨RGBè‰²åŸŸï¼Œæœ€å°åŒ–é¢œè‰²è½¬æ¢æŸå¤±ï¼ŒåŒæ—¶ç¡®ä¿æ‰€æœ‰é¢œè‰²éƒ½åœ¨ç›®æ ‡æ˜¾ç¤ºå™¨çš„å¯æ˜¾ç¤ºèŒƒå›´å†…ã€‚

### æ•°å­¦å»ºæ¨¡ç›®æ ‡
å»ºç«‹ä»Žæºè‰²åŸŸ $\Gamma_{src}$ åˆ°ç›®æ ‡è‰²åŸŸ $\Gamma_{dst}$ çš„æ˜ å°„å‡½æ•°ï¼š
$$f: \Gamma_{src} \rightarrow \Gamma_{dst}$$
ä½¿å¾—è‰²å·®å‡½æ•° $\Delta E(c_{src}, f(c_{src}))$ æœ€å°åŒ–ã€‚

---

## ðŸ”¬ **æ ¸å¿ƒç®—æ³•ä½“ç³»**

### ðŸŽ¯ **ç®—æ³•1ï¼šè‰²å½©ç©ºé—´è½¬æ¢ç®—æ³•**

#### **1.1 sRGBåˆ°çº¿æ€§RGBè½¬æ¢**
```math
\text{çº¿æ€§åŒ–å‡½æ•°ï¼š} \quad \gamma^{-1}(x) = \begin{cases}
\frac{x}{12.92} & \text{if } x \leq 0.04045 \\
\left(\frac{x + 0.055}{1.055}\right)^{2.4} & \text{if } x > 0.04045
\end{cases}
```

**åº”ç”¨**ï¼š
$$RGB_{linear} = \gamma^{-1}(RGB_{sRGB})$$

#### **1.2 çº¿æ€§RGBåˆ°sRGBè½¬æ¢**
```math
\text{ä¼½é©¬æ ¡æ­£å‡½æ•°ï¼š} \quad \gamma(x) = \begin{cases}
12.92 \cdot x & \text{if } x \leq 0.0031308 \\
1.055 \cdot x^{1/2.4} - 0.055 & \text{if } x > 0.0031308
\end{cases}
```

**åº”ç”¨**ï¼š
$$RGB_{sRGB} = \gamma(RGB_{linear})$$

#### **1.3 RGBåˆ°XYZé¢œè‰²ç©ºé—´è½¬æ¢**
**æ ‡å‡†sRGBè½¬æ¢çŸ©é˜µ**ï¼š
$$\begin{bmatrix} X \\ Y \\ Z \end{bmatrix} = \begin{bmatrix}
0.4124564 & 0.3575761 & 0.1804375 \\
0.2126729 & 0.7151522 & 0.0721750 \\
0.0193339 & 0.1191920 & 0.9503041
\end{bmatrix} \begin{bmatrix} R_{linear} \\ G_{linear} \\ B_{linear} \end{bmatrix}$$

#### **1.4 XYZåˆ°RGBé¢œè‰²ç©ºé—´è½¬æ¢**
**é€†è½¬æ¢çŸ©é˜µ**ï¼š
$$\begin{bmatrix} R_{linear} \\ G_{linear} \\ B_{linear} \end{bmatrix} = \begin{bmatrix}
3.2404542 & -1.5371385 & -0.4985314 \\
-0.9692660 & 1.8760108 & 0.0415560 \\
0.0556434 & -0.2040259 & 1.0572252
\end{bmatrix} \begin{bmatrix} X \\ Y \\ Z \end{bmatrix}$$

#### **1.5 XYZåˆ°CIE xyè‰²åº¦åæ ‡è½¬æ¢**
$$x = \frac{X}{X + Y + Z}, \quad y = \frac{Y}{X + Y + Z}$$

**è¾¹ç•Œæ¡ä»¶å¤„ç†**ï¼š
$$\text{å½“ } X + Y + Z = 0 \text{ æ—¶ï¼Œè®¾ç½®ä¸º } 10^{-10} \text{ é¿å…é™¤é›¶}$$

#### **1.6 xyåˆ°XYZè½¬æ¢ï¼ˆç»™å®šäº®åº¦Yï¼‰**
$$X = Y \cdot \frac{x}{y}, \quad Z = Y \cdot \frac{1-x-y}{y}$$

**è¾¹ç•Œæ¡ä»¶**ï¼š
$$\text{å½“ } y = 0 \text{ æ—¶ï¼Œè®¾ç½® } y = 10^{-10}$$

---

### ðŸŽ¨ **ç®—æ³•2ï¼šCIE Labé¢œè‰²ç©ºé—´è½¬æ¢**

#### **2.1 XYZåˆ°Labè½¬æ¢**
**æ ‡å‡†åŒ–åˆ°D65ç™½ç‚¹**ï¼š
$$X_n = 0.95047, \quad Y_n = 1.00000, \quad Z_n = 1.08883$$
$$\tilde{X} = \frac{X}{X_n}, \quad \tilde{Y} = \frac{Y}{Y_n}, \quad \tilde{Z} = \frac{Z}{Z_n}$$

**éžçº¿æ€§å˜æ¢å‡½æ•°**ï¼š
$$f(t) = \begin{cases}
t^{1/3} & \text{if } t > \delta^3 \\
\frac{t}{3\delta^2} + \frac{4}{29} & \text{if } t \leq \delta^3
\end{cases}$$
å…¶ä¸­ $\delta = \frac{6}{29}$

**Labåæ ‡è®¡ç®—**ï¼š
$$L^* = 116 \cdot f(\tilde{Y}) - 16$$
$$a^* = 500 \cdot (f(\tilde{X}) - f(\tilde{Y}))$$
$$b^* = 200 \cdot (f(\tilde{Y}) - f(\tilde{Z}))$$

#### **2.2 CIE Î”E*abè‰²å·®è®¡ç®—**
**æ¬§å‡ é‡Œå¾—è·ç¦»å…¬å¼**ï¼š
$$\Delta E_{ab}^* = \sqrt{(\Delta L^*)^2 + (\Delta a^*)^2 + (\Delta b^*)^2}$$

å…¶ä¸­ï¼š
$$\Delta L^* = L_1^* - L_2^*, \quad \Delta a^* = a_1^* - a_2^*, \quad \Delta b^* = b_1^* - b_2^*$$

---

### ðŸ”º **ç®—æ³•3ï¼šå‡ ä½•è‰²åŸŸæ£€æµ‹**

#### **3.1 ç‚¹åœ¨ä¸‰è§’å½¢å†…åˆ¤æ–­ç®—æ³•ï¼ˆé‡å¿ƒåæ ‡æ³•ï¼‰**
ç»™å®šä¸‰è§’å½¢é¡¶ç‚¹ $P_0, P_1, P_2$ å’Œæµ‹è¯•ç‚¹ $P$ï¼š

**å‘é‡å®šä¹‰**ï¼š
$$\vec{v_0} = P_2 - P_0, \quad \vec{v_1} = P_1 - P_0, \quad \vec{v_2} = P - P_0$$

**ç‚¹ç§¯è®¡ç®—**ï¼š
$$dot_{00} = \vec{v_0} \cdot \vec{v_0}, \quad dot_{01} = \vec{v_0} \cdot \vec{v_1}$$
$$dot_{02} = \vec{v_0} \cdot \vec{v_2}, \quad dot_{11} = \vec{v_1} \cdot \vec{v_1}, \quad dot_{12} = \vec{v_1} \cdot \vec{v_2}$$

**é‡å¿ƒåæ ‡è®¡ç®—**ï¼š
$$invDenom = \frac{1}{dot_{00} \cdot dot_{11} - dot_{01}^2}$$
$$u = (dot_{11} \cdot dot_{02} - dot_{01} \cdot dot_{12}) \cdot invDenom$$
$$v = (dot_{00} \cdot dot_{12} - dot_{01} \cdot dot_{02}) \cdot invDenom$$

**åˆ¤æ–­æ¡ä»¶**ï¼š
$$\text{ç‚¹åœ¨ä¸‰è§’å½¢å†…} \Leftrightarrow (u \geq 0) \land (v \geq 0) \land (u + v \leq 1)$$

#### **3.2 è‰²åŸŸå®šä¹‰**
**BT2020è‰²åŸŸé¡¶ç‚¹ï¼ˆCIE xyåæ ‡ï¼‰**ï¼š
$$V_{BT2020} = \begin{bmatrix}
0.708 & 0.292 \\  \text{(Red)}
0.170 & 0.797 \\  \text{(Green)}
0.131 & 0.046     \text{(Blue)}
\end{bmatrix}$$

**æ ‡å‡†æ˜¾ç¤ºå™¨è‰²åŸŸé¡¶ç‚¹ï¼ˆsRGBï¼‰**ï¼š
$$V_{sRGB} = \begin{bmatrix}
0.640 & 0.330 \\  \text{(Red)}
0.300 & 0.600 \\  \text{(Green)}
0.150 & 0.060     \text{(Blue)}
\end{bmatrix}$$

---

### ðŸ“ **ç®—æ³•4ï¼šæ™ºèƒ½è‰²åŸŸæ˜ å°„**

#### **4.1 è‰²åŸŸä¸­å¿ƒè®¡ç®—**
$$\text{ä¸­å¿ƒç‚¹} = \frac{1}{3}(V_1 + V_2 + V_3) = \begin{bmatrix} \bar{x} \\ \bar{y} \end{bmatrix}$$

å¯¹äºŽsRGBè‰²åŸŸï¼š
$$\text{Center}_{sRGB} = \begin{bmatrix} 0.363 \\ 0.330 \end{bmatrix}$$

#### **4.2 å°„çº¿-çº¿æ®µäº¤ç‚¹ç®—æ³•**
ç»™å®šå°„çº¿èµ·ç‚¹ $O$ï¼Œæ–¹å‘ $\vec{d}$ï¼Œçº¿æ®µç«¯ç‚¹ $P_1, P_2$ï¼š

**å‚æ•°æ–¹ç¨‹**ï¼š
- å°„çº¿ï¼š$R(t) = O + t \cdot \vec{d}$
- çº¿æ®µï¼š$S(u) = P_1 + u \cdot (P_2 - P_1)$

**æ±‚è§£äº¤ç‚¹**ï¼š
$$\vec{edge} = P_2 - P_1$$
$$\vec{toP1} = P_1 - O$$

**2Då‰ç§¯è®¡ç®—**ï¼š
$$cross_{ed} = d_x \cdot edge_y - d_y \cdot edge_x$$
$$t = \frac{toP1_x \cdot edge_y - toP1_y \cdot edge_x}{cross_{ed}}$$
$$u = \frac{toP1_x \cdot d_y - toP1_y \cdot d_x}{cross_{ed}}$$

**æœ‰æ•ˆäº¤ç‚¹æ¡ä»¶**ï¼š
$$(t > 0) \land (0 \leq u \leq 1) \land (|cross_{ed}| > \epsilon)$$

#### **4.3 è‡ªé€‚åº”åŽ‹ç¼©ç­–ç•¥**
**é¢œè‰²ç‰¹å¾æå–**ï¼š
$$saturation = \max(R,G,B) - \min(R,G,B)$$
$$brightness = \frac{R + G + B}{3}$$

**åŽ‹ç¼©å› å­é€‰æ‹©**ï¼š
$$compression\_factor = \begin{cases}
0.85 & \text{if } saturation > 0.8 \text{ (é«˜é¥±å’Œåº¦)} \\
0.90 & \text{if } brightness < 0.3 \text{ (æš—è‰²è°ƒ)} \\
0.88 & \text{otherwise (æ™®é€šæƒ…å†µ)}
\end{cases}$$

**åŽ‹ç¼©æ˜ å°„å…¬å¼**ï¼š
$$P_{compressed} = P_{center} + compression\_factor \cdot (P_{intersection} - P_{center})$$

---

### ðŸŽ¨ **ç®—æ³•5ï¼šHSVé¢œè‰²ç©ºé—´å¤„ç†**

#### **5.1 RGBåˆ°HSVè½¬æ¢**
**äº®åº¦å€¼**ï¼š
$$V = \max(R, G, B)$$

**é¥±å’Œåº¦**ï¼š
$$S = \begin{cases}
0 & \text{if } V = 0 \\
\frac{V - \min(R,G,B)}{V} & \text{otherwise}
\end{cases}$$

**è‰²ç›¸è®¡ç®—**ï¼š
$$\Delta = V - \min(R,G,B)$$
$$H = \begin{cases}
0 & \text{if } \Delta = 0 \\
60 \cdot \frac{G-B}{\Delta} & \text{if } V = R \\
60 \cdot (2 + \frac{B-R}{\Delta}) & \text{if } V = G \\
60 \cdot (4 + \frac{R-G}{\Delta}) & \text{if } V = B
\end{cases}$$

**å½’ä¸€åŒ–**ï¼š
$$H = (H + 360) \bmod 360$$

#### **5.2 HSVåˆ°RGBè½¬æ¢**
**ä¸­é—´å˜é‡**ï¼š
$$C = V \cdot S$$
$$X = C \cdot \left(1 - \left|\left(\frac{H}{60}\right) \bmod 2 - 1\right|\right)$$
$$m = V - C$$

**RGBåˆ†é‡è®¡ç®—**ï¼š
$$(R', G', B') = \begin{cases}
(C, X, 0) & \text{if } 0 \leq H < 60 \\
(X, C, 0) & \text{if } 60 \leq H < 120 \\
(0, C, X) & \text{if } 120 \leq H < 180 \\
(0, X, C) & \text{if } 180 \leq H < 240 \\
(X, 0, C) & \text{if } 240 \leq H < 300 \\
(C, 0, X) & \text{if } 300 \leq H < 360
\end{cases}$$

**æœ€ç»ˆç»“æžœ**ï¼š
$$RGB = (R', G', B') + (m, m, m)$$

---

## ðŸ”„ **å®Œæ•´ç®—æ³•æµç¨‹**

### **ä¸»ç®—æ³•ï¼šå¢žå¼ºè‰²åŸŸæ˜ å°„**
```
è¾“å…¥ï¼šæºRGBé¢œè‰² rgb_src
è¾“å‡ºï¼šæ˜ å°„RGBé¢œè‰² rgb_dst

1. è½¬æ¢åˆ°xyè‰²åº¦åæ ‡ï¼š
   xy_src = RGB_to_xy(rgb_src)

2. è‰²åŸŸæ£€æµ‹ï¼š
   if point_in_triangle(xy_src, sRGB_vertices):
       return rgb_src  // å·²åœ¨ç›®æ ‡è‰²åŸŸå†…
   
3. æ™ºèƒ½åŽ‹ç¼©æ˜ å°„ï¼š
   center = gamut_center(sRGB_vertices)
   direction = normalize(xy_src - center)
   intersection = find_intersection(center, direction, sRGB_vertices)
   
4. è‡ªé€‚åº”åŽ‹ç¼©ï¼š
   compression = adaptive_compression_factor(rgb_src)
   xy_mapped = center + compression * (intersection - center)
   
5. è½¬æ¢å›žRGBï¼š
   Y = mean(rgb_src)  // ä¿æŒäº®åº¦
   rgb_dst = xy_to_RGB(xy_mapped, Y)
   
6. è¾¹ç•Œè£å‰ªï¼š
   return clip(rgb_dst, 0, 1)
```

### **è´¨é‡è¯„ä¼°ç®—æ³•**
```
è¾“å…¥ï¼šæºå›¾åƒ img_srcï¼Œæ˜ å°„å›¾åƒ img_dst
è¾“å‡ºï¼šè´¨é‡è¯„ä¼°æŠ¥å‘Š

1. é€åƒç´ è‰²å·®è®¡ç®—ï¼š
   for each pixel (i,j):
       lab_src = RGB_to_Lab(img_src[i,j])
       lab_dst = RGB_to_Lab(img_dst[i,j])
       delta_e[i,j] = CIE_delta_E(lab_src, lab_dst)

2. ç»Ÿè®¡åˆ†æžï¼š
   mean_de = mean(delta_e)
   median_de = median(delta_e)
   std_de = std(delta_e)
   max_de = max(delta_e)
   
3. è´¨é‡åˆ†çº§ï¼š
   excellent = count(delta_e < 1) / total_pixels
   good = count(1 â‰¤ delta_e < 3) / total_pixels
   acceptable = count(3 â‰¤ delta_e < 6) / total_pixels
   poor = count(6 â‰¤ delta_e < 10) / total_pixels
   very_poor = count(delta_e â‰¥ 10) / total_pixels
```

---

## ðŸ“Š **æ•°å­¦æ¨¡åž‹éªŒè¯**

### **ä¼˜åŒ–ç›®æ ‡å‡½æ•°**
æœ€å°åŒ–æ€»è‰²å·®ï¼š
$$\min_{f} \sum_{i=1}^{N} \Delta E_{ab}^*(c_i, f(c_i))$$

çº¦æŸæ¡ä»¶ï¼š
$$f(c_i) \in \Gamma_{sRGB}, \quad \forall i \in \{1, 2, ..., N\}$$

### **æ€§èƒ½æŒ‡æ ‡**
1. **å¹³å‡è‰²å·®**ï¼š$\bar{\Delta E} = \frac{1}{N}\sum_{i=1}^{N} \Delta E_i$
2. **è‰²å·®æ ‡å‡†å·®**ï¼š$\sigma_{\Delta E} = \sqrt{\frac{1}{N}\sum_{i=1}^{N} (\Delta E_i - \bar{\Delta E})^2}$
3. **ä¼˜ç§€çŽ‡**ï¼š$R_{excellent} = \frac{|\{i: \Delta E_i < 1\}|}{N}$
4. **å¤±çœŸçŽ‡**ï¼š$R_{distortion} = \frac{|\{i: \Delta E_i \geq 10\}|}{N}$

### **ç®—æ³•å¤æ‚åº¦åˆ†æž**
- **æ—¶é—´å¤æ‚åº¦**ï¼š$O(N)$ï¼Œå…¶ä¸­Nä¸ºåƒç´ æ•°
- **ç©ºé—´å¤æ‚åº¦**ï¼š$O(1)$ï¼ŒåŽŸåœ°å¤„ç†
- **æ•°å€¼ç¨³å®šæ€§**ï¼šæ‰€æœ‰é™¤æ³•æ“ä½œéƒ½æœ‰è¾¹ç•Œä¿æŠ¤

---

## ðŸŽ¯ **æ¨¡åž‹åˆ›æ–°ç‚¹**

### **1. è‡ªé€‚åº”åŽ‹ç¼©ç­–ç•¥**
æ ¹æ®é¢œè‰²çš„é¥±å’Œåº¦å’Œäº®åº¦ç‰¹å¾ï¼ŒåŠ¨æ€è°ƒæ•´åŽ‹ç¼©å‚æ•°ï¼Œè€Œéžå›ºå®šçš„çº¿æ€§æ˜ å°„ã€‚

### **2. æ„ŸçŸ¥ä¸€è‡´æ€§ä¿æŒ**
ä½¿ç”¨CIE Labè‰²å½©ç©ºé—´è¿›è¡Œè‰²å·®è®¡ç®—ï¼Œç¡®ä¿æ•°å€¼ç»“æžœä¸Žäººçœ¼æ„ŸçŸ¥ä¸€è‡´ã€‚

### **3. å‡ ä½•è¾¹ç•Œä¼˜åŒ–**
é€šè¿‡å°„çº¿-è¾¹ç•Œäº¤ç‚¹ç®—æ³•ï¼Œæ‰¾åˆ°æœ€ä¼˜çš„æ˜ å°„ç›®æ ‡ç‚¹ï¼Œä¿æŒè‰²å½©çš„ç›¸å¯¹å…³ç³»ã€‚

### **4. å¤šå±‚æ¬¡è´¨é‡è¯„ä¼°**
å»ºç«‹äº†ä»Žåƒç´ çº§åˆ°å›¾åƒçº§çš„å®Œæ•´è´¨é‡è¯„ä¼°ä½“ç³»ï¼Œä¾¿äºŽç®—æ³•ä¼˜åŒ–å’Œå·¥ç¨‹åº”ç”¨ã€‚

---

## ðŸ“š **æ•°å­¦ç†è®ºåŸºç¡€**

### **è‰²å½©ç§‘å­¦ç†è®º**
- **CIE 1931è‰²åº¦å­¦ç³»ç»Ÿ**ï¼šå»ºç«‹äº†è®¾å¤‡æ— å…³çš„é¢œè‰²æè¿°æ ‡å‡†
- **Labå‡åŒ€è‰²å½©ç©ºé—´**ï¼šæä¾›æ„ŸçŸ¥ä¸€è‡´çš„è‰²å·®åº¦é‡
- **è‰²åŸŸæ˜ å°„ç†è®º**ï¼šåœ¨ä¿æŒè§†è§‰è´¨é‡çš„å‰æä¸‹è¿›è¡Œè‰²å½©è½¬æ¢

### **å‡ ä½•ç®—æ³•ç†è®º**
- **è®¡ç®—å‡ ä½•**ï¼šç‚¹åœ¨å¤šè¾¹å½¢å†…åˆ¤æ–­ã€å°„çº¿æ±‚äº¤ç®—æ³•
- **ä»¿å°„å˜æ¢**ï¼šè‰²åŸŸé—´çš„å‡ ä½•æ˜ å°„å…³ç³»
- **ä¼˜åŒ–ç†è®º**ï¼šçº¦æŸä¼˜åŒ–é—®é¢˜çš„æ±‚è§£æ–¹æ³•

### **æ•°å€¼è®¡ç®—ç†è®º**
- **æ•°å€¼ç¨³å®šæ€§**ï¼šé¿å…é™¤é›¶å’Œæµ®ç‚¹æº¢å‡º
- **è¯¯å·®æŽ§åˆ¶**ï¼šæŽ§åˆ¶ç´¯ç§¯è¯¯å·®åœ¨å¯æŽ¥å—èŒƒå›´å†…
- **è¾¹ç•Œå¤„ç†**ï¼šç¡®ä¿æ‰€æœ‰è®¡ç®—ç»“æžœåœ¨æœ‰æ•ˆåŸŸå†…

è¿™ä¸ªæ•°å­¦æ¨¡åž‹åœ¨ç†è®ºä¸¥è°¨æ€§å’Œå·¥ç¨‹å®žç”¨æ€§ä¹‹é—´å–å¾—äº†è‰¯å¥½çš„å¹³è¡¡ï¼Œä¸ºLEDæ˜¾ç¤ºå±é¢œè‰²è½¬æ¢æä¾›äº†å®Œæ•´çš„è§£å†³æ–¹æ¡ˆã€‚
